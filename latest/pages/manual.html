<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manual · DaskDistributedDispatcher.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/invenia.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DaskDistributedDispatcher.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li class="current"><a class="toctext" href="manual.html">Manual</a><ul class="internal"><li><a class="toctext" href="#Motivation-1">Motivation</a></li><li><a class="toctext" href="#Design-1">Design</a></li><li><a class="toctext" href="#Prerequisites-1">Prerequisites</a></li><li><a class="toctext" href="#Setup-1">Setup</a></li><li><a class="toctext" href="#Usage-1">Usage</a></li><li><a class="toctext" href="#Additional-notes-1">Additional notes</a></li></ul></li><li><a class="toctext" href="api.html">API</a></li><li><a class="toctext" href="workers.html">Workers</a></li><li><a class="toctext" href="communication.html">Communication</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="manual.html">Manual</a></li></ul><a class="edit-page" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/9213214c7167020613b13715ca483a88963b7cfd/docs/src/pages/manual.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Manual</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Manual-1" href="#Manual-1">Manual</a></h1><h2><a class="nav-anchor" id="Motivation-1" href="#Motivation-1">Motivation</a></h2><p>The primary reason for integrating the <a href="https://distributed.readthedocs.io/en/latest/index.html"><code>dask.distributed</code></a> scheduler with <a href="https://invenia.github.io/Dispatcher.jl/stable/"><code>Dispatcher.jl</code></a> is to be able to guarantee a stronger degree of effiency for computations run and to allow for fluctuating worker resources. Note that removing workers from the worker pool may cause errors when fetching results. Only remove workers once you no longer need access to their information.</p><p>Using the <code>dask-scheduler</code> and executing compuations in a distributed manner can <a href="https://distributed.readthedocs.io/en/latest/efficiency.html"><code>add overhead for simple tasks</code></a>. Consider using an <a href="https://invenia.github.io/Dispatcher.jl/latest/pages/api.html#AsyncExecutor-1"><code>AsyncExecuter</code></a> or <a href="https://invenia.github.io/Dispatcher.jl/latest/pages/api.html#ParallelExecutor-1"><code>ParallelExecuter</code></a> if possible. The advantage that using the <code>dask-scheduler</code> has is that it schedules computations in a manner that is <a href="https://distributed.readthedocs.io/en/latest/scheduling-policies.html"><code>short-term-efficient and long-term-fair</code></a>.</p><h2><a class="nav-anchor" id="Design-1" href="#Design-1">Design</a></h2><p>The key components of this system are:</p><ul><li><p>the <a href="https://distributed.readthedocs.io/en/latest/scheduling-policies.html"><code>dask-scheduler</code></a> process that schedules computations and manages state</p></li><li><p>a julia <a href="api.html#DaskDistributedDispatcher.Client"><code>Client</code></a> or <a href="api.html#DaskDistributedDispatcher.DaskExecutor"><code>DaskExecutor</code></a> that submits work to the scheduler</p></li><li><p>julia <a href="workers.html#DaskDistributedDispatcher.Worker"><code>Worker</code></a>s that accept instructions from the scheduler, fetch dependencies, execute compuations, store data, and communicate state to the scheduler</p></li></ul><h2><a class="nav-anchor" id="Prerequisites-1" href="#Prerequisites-1">Prerequisites</a></h2><p>Python 2.7 or 3.5, conda or pip, and the python package <code>dask.distributed</code> needs to be installed (<a href="http://distributed.readthedocs.io/en/latest/install.html"><code>instructions here</code></a>) before using this package.</p><h2><a class="nav-anchor" id="Setup-1" href="#Setup-1">Setup</a></h2><p>First, start a dask-scheduler process in a terminal:</p><pre><code class="language-none">$ dask-scheduler
Scheduler started at 127.0.0.1:8786</code></pre><p>Then, in a julia session set up a <a href="https://docs.julialang.org/en/stable/manual/parallel-computing/#clustermanagers"><code>cluster</code></a> of julia processes and initialize the workers by providing them with the dask-scheduler&#39;s tcp address:</p><pre><code class="language-julia">using DaskDistributedDispatcher

addprocs(3)
@everywhere using DaskDistributedDispatcher

for i in 1:3
  @spawn Worker(&quot;127.0.0.1:8786&quot;)
end</code></pre><h2><a class="nav-anchor" id="Usage-1" href="#Usage-1">Usage</a></h2><p>Submit <a href="https://invenia.github.io/Dispatcher.jl/latest/pages/api.html#DispatchNode-1"><code>DispatchNode</code></a>s units of computation that can be run to the <a href="api.html#DaskDistributedDispatcher.DaskExecutor"><code>DaskExecutor</code></a> (which will relay them to the <code>dask-scheduler</code> to be scheduled and executed on a <a href="workers.html#DaskDistributedDispatcher.Worker"><code>Worker</code></a>):</p><pre><code class="language-julia">using Dispatcher
using ResultTypes

data = [1, 2, 3]

ctx = @dispatch_context begin
    a = @op 1 + 2
	x = @op a + 3
	y = @op a + 1

    result = @op x * y
end

executor = DaskExecutor(&quot;127.0.0.1:8786&quot;)
(run_result,) = run!(executor, ctx, [result])

run_future = unwrap(run_result)
@assert fetch(run_future) == 24</code></pre><p><strong>Note</strong>: There must be at least one <a href="workers.html#DaskDistributedDispatcher.Worker"><code>Worker</code></a> running or else <code>run!</code> will hang indefinetely. Also, if the dask-scheduler is running on the same machine as the <a href="api.html#DaskDistributedDispatcher.DaskExecutor"><code>DaskExecutor</code></a> and on its default port (8786), the address can be ommitted when initializing <a href="workers.html#DaskDistributedDispatcher.Worker"><code>Worker</code></a>s and <a href="api.html#DaskDistributedDispatcher.DaskExecutor"><code>DaskExecutor</code></a>s.</p><pre><code class="language-julia">@spawn Worker()

executor = DaskExecutor()</code></pre><p>See <a href="api.html#DaskDistributedDispatcher.DaskExecutor"><code>DaskExecutor</code></a> and <a href="https://invenia.github.io/Dispatcher.jl/latest/pages/manual.html"><code>Dispatcher.jl</code></a> for more usage information.</p><h2><a class="nav-anchor" id="Additional-notes-1" href="#Additional-notes-1">Additional notes</a></h2><p>Using a <code>Channel</code> and/or <code>Future</code> in computations submitted to the <code>DaskExecutor</code> is not supported. Instead use a <a href="https://github.com/invenia/DeferredFutures.jl"><code>DeferredChannel</code> or <code>DeferredFuture</code></a>. </p><p>It is possible to bypass the <a href="api.html#DaskDistributedDispatcher.DaskExecutor"><code>DaskExecutor</code></a> by accessing its <code>client</code> variable for more advanced workflows such as cancelling previously submitted computations or asking the scheduler to replicate data across all workers. See <a href="api.html#DaskDistributedDispatcher.Client"><code>Client</code></a> for more information.</p><p>When done your computations, to get the <code>dask-scheduler</code> to reset and delete all previously computed values without restarting the <a href="workers.html#DaskDistributedDispatcher.Worker"><code>Worker</code></a>s and the <code>dask-scheduler</code> call:</p><pre><code class="language-julia">reset(executor)</code></pre><footer><hr/><a class="previous" href="../index.html"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="api.html"><span class="direction">Next</span><span class="title">API</span></a></footer></article></body></html>

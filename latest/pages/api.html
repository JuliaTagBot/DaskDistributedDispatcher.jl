<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · DaskDistributedDispatcher.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/highlightjs/default.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/invenia.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DaskDistributedDispatcher.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><a class="toctext" href="manual.html">Manual</a></li><li class="current"><a class="toctext" href="api.html">API</a><ul class="internal"><li><a class="toctext" href="#Client-1">Client</a></li><li><a class="toctext" href="#Worker-1">Worker</a></li><li><a class="toctext" href="#Server-1">Server</a></li><li><a class="toctext" href="#Address-1">Address</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href="api.html">API</a></li></ul><a class="edit-page" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/docs/src/pages/api.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>API</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="API-1" href="#API-1">API</a></h1><h2><a class="nav-anchor" id="Client-1" href="#Client-1">Client</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.Client" href="#DaskDistributedDispatcher.Client"><code>DaskDistributedDispatcher.Client</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">Client</code></pre><p>A <code>Client</code> represents a client that the user can interact with to submit computations to the scheduler and gather results.</p><p><strong>Fields</strong></p><ul><li><p><code>ops::Dict{String, Dispatcher.Op}</code>: maps keys to their dispatcher <code>ops</code></p></li><li><p><code>id::String</code>: this client&#39;s identifier</p></li><li><p><code>status::String</code>: status of this client</p></li><li><p><code>scheduler_address::Address</code>: the dask-distributed scheduler ip address and port information</p></li><li><p><code>scheduler::Rpc</code>: manager for discrete send/receive open connections to the scheduler</p></li><li><p><code>connecting_to_scheduler::Bool</code>: if client is currently trying to connect to the scheduler</p></li><li><p><code>scheduler_comm::Nullable{BatchedSend}</code>: batched stream for communication with scheduler</p></li><li><p><code>pending_msg_buffer::Array</code>: pending msgs to send on the batched stream</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L6-L21">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.Client-Tuple{String}" href="#DaskDistributedDispatcher.Client-Tuple{String}"><code>DaskDistributedDispatcher.Client</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">Client(scheduler_address::String; throw_errors::Bool=true) -&gt; Client</code></pre><p>Construct a <code>Client</code> which can then be used to submit computations or gather results from the dask-scheduler process. Set throw_errors to <code>false</code> if you want to instead receive string representations of any errors thrown while running a user submitted task.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L34-L40">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.submit-Tuple{DaskDistributedDispatcher.Client,Dispatcher.Op}" href="#DaskDistributedDispatcher.submit-Tuple{DaskDistributedDispatcher.Client,Dispatcher.Op}"><code>DaskDistributedDispatcher.submit</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">submit(client::Client, op::Dispatcher.Op; workers::Array=[])</code></pre><p>Submit the <code>Op</code> computation unit to the dask-scheduler for computation.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L58-L62">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.result-Tuple{DaskDistributedDispatcher.Client,Dispatcher.Op}" href="#DaskDistributedDispatcher.result-Tuple{DaskDistributedDispatcher.Client,Dispatcher.Op}"><code>DaskDistributedDispatcher.result</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">result(client::Client, op::Dispatcher.Op) -&gt; Any</code></pre><p>Gather the result of the <code>Op</code> computation unit. Requires there to be at least one worker available to the scheduler or hangs indefinetely.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L106-L111">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.cancel-Tuple{DaskDistributedDispatcher.Client,Array{Dispatcher.Op,N}}" href="#DaskDistributedDispatcher.cancel-Tuple{DaskDistributedDispatcher.Client,Array{Dispatcher.Op,N}}"><code>DaskDistributedDispatcher.cancel</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">cancel(client::Client, ops::Array{Dispatcher.Op})</code></pre><p>Cancel all <code>Op</code>s in <code>ops</code>. This stops future tasks from being scheduled if they have not yet run and deletes them if they have already run. After calling, this result and all dependent results will no longer be accessible.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L139-L145">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.gather-Tuple{DaskDistributedDispatcher.Client,Array{Dispatcher.Op,N}}" href="#DaskDistributedDispatcher.gather-Tuple{DaskDistributedDispatcher.Client,Array{Dispatcher.Op,N}}"><code>DaskDistributedDispatcher.gather</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">gather(client::Client, ops::Array{Dispatcher.Op})</code></pre><p>Gather the results of all <code>ops</code>. Requires there to be at least one worker available to the scheduler or hangs indefinetely waiting for the results.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L150-L155">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.shutdown-Tuple{DaskDistributedDispatcher.Client}" href="#DaskDistributedDispatcher.shutdown-Tuple{DaskDistributedDispatcher.Client}"><code>DaskDistributedDispatcher.shutdown</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">shutdown(client::Client)</code></pre><p>Tell the dask-scheduler to terminate idle workers and that this client is shutting down. Does NOT terminate the scheduler itself. This does not have to be called after a session but is useful when you want to delete all the information submitted by the client from the scheduler and workers (such as between test runs). If you want to reconnect to the scheduler after calling this function you will have to set up a new client.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L174-L182">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.default_client-Tuple{}" href="#DaskDistributedDispatcher.default_client-Tuple{}"><code>DaskDistributedDispatcher.default_client</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">default_client()</code></pre><p>Return the default global client if a client has been registered with the dask-scheduler.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L212-L216">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.get_key-Tuple{Dispatcher.Op}" href="#DaskDistributedDispatcher.get_key-Tuple{Dispatcher.Op}"><code>DaskDistributedDispatcher.get_key</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">get_key(op::Dispatcher.Op)</code></pre><p>Calculate an identifying key for <code>op</code>. Keys are re-used for identical <code>ops</code> to avoid unnecessary computations.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/client.jl#L230-L235">source</a><br/></section><h2><a class="nav-anchor" id="Worker-1" href="#Worker-1">Worker</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.Worker" href="#DaskDistributedDispatcher.Worker"><code>DaskDistributedDispatcher.Worker</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">Worker</code></pre><p>A <code>Worker</code> represents a worker endpoint in the distributed cluster that accepts instructions from the scheduler, fetches dependencies, executes compuations, stores data, and communicates state to the scheduler.</p><p><strong>Fields</strong></p><p><strong>Communication Management</strong></p><ul><li><p><code>scheduler_address::Address</code>: the dask-distributed scheduler ip address and port information</p></li><li><p><code>batched_stream::Nullable{BatchedSend}</code>: batched stream for communication with scheduler</p></li><li><p><code>scheduler::Rpc</code>: manager for discrete send/receive open connections to the scheduler</p></li><li><p><code>target_message_size::AbstractFloat</code>: target message size for messages</p></li><li><p><code>connection_pool::ConnectionPool</code>: manages connections to peers</p></li><li><p><code>total_connections::Integer</code>: maximum number of concurrent connections allowed</p></li></ul><p><strong>Server</strong></p><ul><li><p><code>address::Address</code>:: ip address and port that this worker is listening on</p></li><li><p><code>listener::Base.TCPServer</code>: tcp server that listens for incoming connections</p></li><li><p><code>comms::Dict{TCPSocket, String}</code>: current accepted connections to this worker</p></li></ul><p><strong>Handlers</strong></p><ul><li><p><code>handlers::Dict{String, Function}</code>: handlers for operations requested by open connections</p></li><li><p><code>compute_stream_handlers::Dict{String, Function}</code>: handlers for compute stream operations</p></li></ul><p><strong>Data management</strong></p><ul><li><p><code>data::Dict{String, Any}</code>: maps keys to the results of function calls (actual values)</p></li><li><p><code>futures::Dict{String, DeferredFutures.DeferredFuture}</code>: maps keys to their DeferredFuture</p></li><li><p><code>nbytes::Dict{String, Integer}</code>: maps keys to the size of their data</p></li><li><p><code>types::Dict{String, Type}</code>: maps keys to the type of their data</p></li></ul><p><strong>Task management</strong></p><ul><li><p><code>tasks::Dict{String, Tuple}</code>: maps keys to the function, args, and kwargs of a task</p></li><li><p><code>task_state::Dict{String, String}</code>: maps keys tot heir state: (waiting, executing, memory)</p></li><li><p><code>priorities::Dict{String, Tuple}</code>: run time order priority of a key given by the scheduler</p></li><li><p><code>priority_counter::Integer</code>: used to also prioritize tasks by their order of arrival</p></li></ul><p><strong>Task state management</strong></p><ul><li><p><code>transitions::Dict{Tuple, Function}</code>: valid transitions that a task can make</p></li><li><p><code>data_needed::Deque{String}</code>: keys whose data we still lack</p></li><li><p><code>ready::PriorityQueue{String, Tuple, Base.Order.ForwardOrdering}</code>: keys ready to run</p></li><li><p><code>executing::Set{String}</code>: keys that are currently executing</p></li></ul><p><strong>Dependency management</strong></p><ul><li><p><code>dep_transitions::Dict{Tuple, Function}</code>: valid transitions that a dependency can make</p></li><li><p><code>dep_state::Dict{String, String}</code>: maps dependencies with their state   (waiting, flight, memory)</p></li><li><p><code>dependencies::Dict{String, Set}</code>: maps a key to the data it needs to run</p></li><li><p><code>dependents::Dict{String, Set}</code>: maps a dependency to the keys that use it</p></li><li><p><code>waiting_for_data::Dict{String, Set}</code>: maps a key to the data it needs that we don&#39;t have</p></li><li><p><code>pending_data_per_worker::DefaultDict{String, Deque}</code>: data per worker that we want</p></li><li><p><code>who_has::Dict{String, Set}</code>: maps keys to the workers believed to have their data</p></li><li><p><code>has_what::DefaultDict{String, Set{String}}</code>: maps workers to the data they have</p></li></ul><p><strong>Peer communication</strong></p><ul><li><p><code>in_flight_tasks::Dict{String, String}</code>: maps a dependency and the peer connection for it</p></li><li><p><code>in_flight_workers::Dict{String, Set}</code>: workers from which we are getting data from</p></li><li><p><code>suspicious_deps::DefaultDict{String, Integer}</code>: number of times a dependency has not been   where it is expected</p></li><li><p><code>missing_dep_flight::Set{String}</code>: missing dependencies</p></li></ul><p><strong>Informational</strong></p><ul><li><p><code>status::String</code>: status of this worker</p></li><li><p><code>exceptions::Dict{String, String}</code>: maps erred keys to the exception thrown while running</p></li><li><p><code>tracebacks::Dict{String, String}</code>: maps erred keys to the exception&#39;s traceback thrown</p></li><li><p><code>startstops::DefaultDict{String, Array}</code>: logs of transfer, load, and compute times</p></li></ul><p><strong>Validation</strong></p><ul><li><p><code>validate::Bool</code>: decides if the worker validates its state during execution</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/worker.jl#L4-L74">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.Worker-Tuple{String}" href="#DaskDistributedDispatcher.Worker-Tuple{String}"><code>DaskDistributedDispatcher.Worker</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">Worker(scheduler_address::String; validate=true)</code></pre><p>Create a <code>Worker</code> that listens on a random port between 1024 and 9000 for incoming messages. Set <code>validate</code> to false to improve performance.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/worker.jl#L137-L142">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.address-Tuple{DaskDistributedDispatcher.Worker}" href="#DaskDistributedDispatcher.address-Tuple{DaskDistributedDispatcher.Worker}"><code>DaskDistributedDispatcher.address</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">address(server::Server) -&gt; String</code></pre><p>Return this server&#39;s address formatted as an String</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/comm.jl#L10-L14">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.show-Tuple{IO,DaskDistributedDispatcher.Worker}" href="#Base.show-Tuple{IO,DaskDistributedDispatcher.Worker}"><code>Base.show</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">show(io::IO, worker::Worker)</code></pre><p>Print a representation of the worker and it&#39;s state.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/worker.jl#L239-L243">source</a><br/></section><h2><a class="nav-anchor" id="Server-1" href="#Server-1">Server</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.Server" href="#DaskDistributedDispatcher.Server"><code>DaskDistributedDispatcher.Server</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">Server</code></pre><p>Abstract type to listen for and handle incoming messages.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/comm.jl#L3-L7">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.address" href="#DaskDistributedDispatcher.address"><code>DaskDistributedDispatcher.address</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">address(server::Server) -&gt; String</code></pre><p>Return this server&#39;s address formatted as an String</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/comm.jl#L10-L14">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.start_listening" href="#DaskDistributedDispatcher.start_listening"><code>DaskDistributedDispatcher.start_listening</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">listen(server::Server)</code></pre><p>Listen for incoming connections on a port and dispatches them to be handled.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/comm.jl#L17-L21">source</a><br/></section><h2><a class="nav-anchor" id="Address-1" href="#Address-1">Address</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.Address" href="#DaskDistributedDispatcher.Address"><code>DaskDistributedDispatcher.Address</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">Address</code></pre><p>A representation of an endpoint that can be connected to. It is categorized by its scheme (tcp is currently the only protocol supported), host, and port.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/address.jl#L1-L6">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.Address-Tuple{String}" href="#DaskDistributedDispatcher.Address-Tuple{String}"><code>DaskDistributedDispatcher.Address</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">Address(address::String) -&gt; Address</code></pre><p>Parse <code>address</code> and returns the corresponding <code>Address</code> object.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/address.jl#L13-L17">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DaskDistributedDispatcher.Address-Tuple{Union{IPAddr,String},Integer}" href="#DaskDistributedDispatcher.Address-Tuple{Union{IPAddr,String},Integer}"><code>DaskDistributedDispatcher.Address</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-none">Address(address::String) -&gt; Address</code></pre><p>Return the corresponding <code>Address</code> object to the components <code>host</code> and <code>port</code>. By default the tcp protocol is assumed.</p></div><a class="source-link" target="_blank" href="https://github.com/invenia/DaskDistributedDispatcher.jl/tree/4d6350bfc84fef2b793f7516e479780c418f584a/src/address.jl#L22-L27">source</a><br/></section><footer><hr/><a class="previous" href="manual.html"><span class="direction">Previous</span><span class="title">Manual</span></a></footer></article></body></html>
